var __extends=this&&this.__extends||function(t,i){function e(){this.constructor=t}for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)};!function(){var t=function(t){function i(i,e,s,o,h,r){void 0===h&&(h="head-a.png"),void 0===r&&(r=10),t.call(this,i,h),this.name="游客"+(new Date).getTime().toString().substr(-5),this.score=0,this.score=r,this.setSize(),this.url=h,this.shape=SHAPE.circle,this.name=o||this.name}return __extends(i,t),i.prototype.draw=function(i){this.setSize(),t.prototype.draw.call(this,i);var e=new WriteText(this.context);e.write(this.name,this.x,this.y+this.r,null,"#cccccc")},i.prototype.drop=function(t){this.setPosition(this.x,this.y+t)},i.prototype.eat=function(t){var i=this;void 0===t&&(t="eat-a.png"),this.setImg(t),setTimeout(function(){return i.setImg(i.url)},300)},i.prototype.setSize=function(){var i=5*Math.sqrt(this.score);t.prototype.setSize.call(this,2*i,2*i)},i}(Sprite),i=function(t){function i(i){t.call(this,i,10,10,void 0,"head.png"),this.context=i,this.score=0,this.angle=0,this.v=1,this.vx=this.v,this.vy=this.v;var e=10+Math.floor(10*Math.random());this.score=e;var s=Math.floor(Math.random()*names.length-1);this.name=names[s],names.splice(s,1),this.trans(),this.setSize()}return __extends(i,t),i.prototype.trans=function(){return this.angle=Math.atan2(-1+2*Math.random(),-1+2*Math.random()),this.angle},i.prototype.move=function(t){var i=0;1e3*Math.random()<3&&this.trans(),i=-this.angle,0!=i&&(this.vx=Math.cos(i)*this.v,this.vy=Math.sin(i)*this.v),this.x=this.vx+this.x,this.y=this.y-this.vy,this.x=Math.max(0,this.x),this.x=Math.min(this.x,t.width-this.w),this.y=Math.max(0,this.y),this.y=Math.min(this.y,t.height-this.h),0!=this.x&&0!=this.y&&this.x!=t.width-this.w&&this.y!=t.height-this.h||this.trans()},i.prototype.draw=function(){t.prototype.draw.call(this,this.angle)},i.prototype.eat=function(){t.prototype.eat.call(this,"eat.png")},i}(t),e=function(e){function s(){e.apply(this,arguments),this.roleSize=10,this.v=1,this.av=0,this.vx=this.v,this.vy=this.v,this.ballList=[],this.score=10,this.zdList=[],this.robotList=[]}return __extends(s,e),s.prototype.newGame=function(){this.init(),this.createRole(),this.createRobot(),e.prototype.newGame.call(this)},s.prototype.init=function(){this.score=10,this.ballList=[],this.zdList=[],this.robotList=[]},s.prototype.createRobot=function(){for(var t=this.robotList.length;t<15;t++){var e=new i(this.context);e.x=Math.random()*this.stage.width,e.y=Math.random()*this.stage.height,e.r=e.h/2,this.robotList.push(e)}},s.prototype.createRole=function(){this.role=new t(this.context,this.roleSize,this.roleSize),this.role.x=this.stage.width/2,this.role.y=this.stage.height/2,this.role.r=this.role.h/2},s.prototype.running=function(){e.prototype.running.call(this),this.move(),this.role.draw(this.angle),this.createBallList(),this.drawBallList(),this.checkHits(),this.drawZdList(),this.drawRobot(),this.createRobot(),this.moveScreen(),this.scoreScreen.change("得分："+this.role.score.toString())},s.prototype.moveScreen=function(){var t=this.view.clientHeight,i=this.view.clientWidth,e=Math.floor(this.role.x-i/2),s=Math.floor(this.role.y-t/2),o=this.stage.width-i,h=this.stage.height-t;this.stage.elem.style.left=-Math.min(o,Math.max(0,e))+"px",this.stage.elem.style.top=-Math.min(h,Math.max(0,s))+"px"},s.prototype.drawZdList=function(){this.zdList.forEach(function(t){t.draw()})},s.prototype.drawRobot=function(){var t=this;this.robotList.forEach(function(i){i.move(t.stage),i.draw()})},s.prototype.createZd=function(){for(var t=0;t<4;t++){var i=new Sprite(this.context,"zd.png");this.zdList.push(i),i.setSize(10,10);var e=this.stage.width/4,s=this.stage.height/4;0==t&&i.setPosition(e,s),1==t&&i.setPosition(this.stage.width-e,s),2==t&&i.setPosition(e,this.stage.height-s),3==t&&i.setPosition(this.stage.width-e,this.stage.height-s),i.shape=SHAPE.circle}},s.prototype.checkHits=function(){var t=this;this.ballList.forEach(function(i,e){t.hits(t.role,i)&&(t.role.score++,t.role.setSize(),t.ballList.splice(e,1),t.role.eat()),t.robotList.forEach(function(s,o){t.hits(s,i)&&(s.score++,s.setSize(),t.ballList.splice(e,1),s.eat()),t.hits(s,t.role)&&(s.score>t.role.score?t.over():s.score<t.role.score&&(t.role.score+=s.score,t.robotList.splice(o,1)))})}),this.robotList.forEach(function(i,e){t.robotList.forEach(function(s,o){e!=o&&t.hits(i,s)&&i.score!=s.score&&(i.score>s.score?(i.score+=s.score,t.robotList.splice(o,1)):(s.score+=i.score,t.robotList.splice(e,1)))})}),this.zdList.forEach(function(i){t.hits(t.role,i)&&t.over(),t.robotList.forEach(function(e,s){t.hits(e,i)&&t.robotList.splice(s,1)})})},s.prototype.drawBallList=function(){this.ballList.forEach(function(t){t.draw()})},s.prototype.createBallList=function(){for(var t=300-this.ballList.length,i=0;i<t;i++){var e=new Sprite(this.context,"head.png");this.ballList.push(e),e.setSize(5,5),e.x=Math.random()*this.stage.width,e.y=Math.random()*this.stage.height,e.shape=SHAPE.circle}},s.prototype.move=function(){var t=this.controlStage.getAngle();this.angle=-t,0!=t&&(this.vx=Math.cos(t)*this.v,this.vy=Math.sin(t)*this.v),this.role.x=this.vx+this.role.x,this.role.y=this.role.y-this.vy,this.role.x=Math.max(0,this.role.x),this.role.x=Math.min(this.role.x,this.stage.width-this.role.w),this.role.y=Math.max(0,this.role.y),this.role.y=Math.min(this.role.y,this.stage.height-this.role.h)},s.prototype.gameOver=function(){e.prototype.gameOver.call(this),this.gameOverStage.setText("得分："+this.role.score)},s.prototype.loading=function(){console.log("loading..."),e.prototype.loading.call(this)},s}(JY);setTimeout(function(){var t=document.getElementById("view"),i=t.offsetWidth,s=t.offsetHeight,o=new Stage(3*i,3*s),h=new Discript("start");h.text='<p class="title">大头吃小头</p>';var r=new GameOver("restart"),a=new Title("大头吃小头"),n=new Control;n.rect=[100,100];var c=new e(t,o,a,h,r,n);c.files={image:["head.png","head-a.png","eat-a.png","eat.png","zd.png"]},c.setup()},1e3)}();
//# sourceMappingURL=headofoperations.js.map
